# 로드 밸런싱(Load Balancing)이란?

> 말 그대로 서버 요청(Load)을 여러 대로 나누어서(Balancing) 처리하는 것

인터넷 발전으로 서버에서 처리해야 하는 트래픽의 양이 엄청나게 많아졌고, 이를 감당하기 위해 여러 서버로 분산시켜주는 기술이 필요하게 되었는데, 이게 바로 로드 밸런싱이다.
즉, 로드 밸런싱은 한 서버로 트래픽이 몰려 과부하가 일어나는 것을 막아준다.

- 트래픽이 많아졌을 때 사용할 수 있는 방법은 아래와 같은 두 가지가 있다.

1. Scale-up : 기존 서버 성능 확장하기
2. Scale-out : 서버 증설

이때 로드 밸런싱은 Scale-out 방식에서 필수적이다.

# 로드 밸런싱의 장점

#### 1) 가용성

- 트래픽 과부하로 방문자가 애플리케이션을 사용하지 못하는 것을 막아준다.
- 로드 밸런서는 서버에 문제가 생기면 자동으로 감지해 트래픽을 재분배하기 때문에 가용성을 개선하는 데 도움이 된다.

#### 2) 확장성

- 많은 양의 트래픽도 처리할 수 있기 때문에 애플리케이션의 확장에도 도움이 된다.
- 한 서버에서의 트래픽 병목 현상을 예방한다.
- 트래픽을 예상해서 서버를 추가하거나 제거 가능하다.

#### 3) 보안

- 보안 기능이 내장되어 있어서 서버 장애를 일으키는 공격을 예방할 수 있다.

#### 4) 성능 개선

- 서버 지연 시간을 줄이고 응답 시간을 늘려 성능 개선에 기여한다.
- 서버 간 부하를 균등 분배한다.
- 지리적으로 가까운 서버에 redirect해서 지연 시간을 단축시킨다.

# 로드 밸런싱 기법

![](https://velog.velcdn.com/images/urjimyu/post/28f1525f-e50a-47f4-9bf0-3980da67ed4a/image.png)

### 정적 로드 밸런싱 기법

: 정해진 규칙에 따른 알고리즘으로 로드 밸런싱을 하며, 현재 서버 상태와는 독립적으로 이루어진다.

#### 1. 라운드로빈 방식(Round Robin Method)

- 서버 요청을 순서대로 돌아가며 배정
- 서버들이 모두 동일 스펙이며 서버 연결이 오래 지속되지 않을 때 사용하기에 적절하다.

#### 2. 가중 라운드로빈 방식(Weighted Round Robin Method)

- 각 서버마다 가중치를 부여해서 가중치가 높은 순으로 서버 요청을 우선 배정
- 주로 서버마다 트래픽 처리 능력이 다를 때 사용한다

#### 3. IP 해시 방식(IP Hash Method)

- 사용자 IP를 해싱해서 특정 서버로 매핑해 요청 분배
- 사용자가 항상 동일 서버로 연결되는 걸 보장

### 동적 로드 밸런싱 기법

: 트래픽을 분배하기 전에 현재 서버들의 상태를 확인한다.

#### 4. 최소 연결 방식(Least Connection Method)

- 요청 들어온 시점 기준 가장 적은 연결상태인 서버에 우선 배분
- 세션이 자주 길어지거나 서버에 분배된 트래픽이 일정하지 않을 때 적합

#### 5. 가중 최소 연결 방식(Weighted Least Connection Method)

- 수용 가능한 로드에 따라 서버에 가중치를 부여해서 용량 대비 적은 연결이 이루어진 서버 순으로 트래픽을 분산한다.

#### 6. 최소 응답 시간 방식(Least Response Time Method)

- 서버 현재 연결 상태와 응답 시간을 고려해서 트래픽 배분
- 가장 연결이 적고 응답시간이 짧은 서버에 우선 배분한다.

#### 7. 리소스 기반 방식(Resource-based method)

- 현재 서버 부하 상태를 파악해서 트래픽을 배분한다.
- agent(특수 소프트웨어)가 각 서버에서 작동하면서 서버 리소스 사용량을 계산한다.(컴퓨팅 용량 및 메모리 등)
  이후 로드 밸런서가 가용 리소스가 충분한지 확인하고 트래픽을 분산한다.

# 로드 밸런싱 종류

가장 대표적으로 사용되는 로드 밸런싱에는 L4, L7이 있다.

> - L4 : Layer 4(전송 계층) 프로토콜

- L7 : Layer 7(응용 계층) 프로토콜

➡️ 해당 계층 프로토콜 헤더를 부하 분산에 사용하기 때문이 붙은 이름이다.

## L4 로드 밸런서

- 네트워크 계층(IP, IPX) / 전송 계층(TCP, UDP)의 정보(IP주소, 포트번호, MAC주소, 전송 프로토콜)를 바탕으로 로드 밸런싱을 한다.

## L7 로드밸런서

- 애플리케이션 계층에서 로드 분산
- HTTP 헤더, 쿠키 같은 사용자 요청 기준으로 특정 서버에 트래픽 분산이 가능
- 특정 패턴을 가진 바이러스를 감지해 네트워크 보호가 가능하다
- 비정상적인 트래픽(DoS/DDoS) 필터링이 가능해 네트워크 보안 분야에서도 활용된다

---

## 참고문헌📚

[Tecoble 로드 밸런싱에 대해 알아보자!](https://tecoble.techcourse.co.kr/post/2021-11-07-load-balancing/)
[AWS - What is Load Balancing?](https://aws.amazon.com/what-is/load-balancing/#:~:text=Load%20balancing%20is%20the%20method,a%20fast%20and%20reliable%20manner.)
